<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>D&D App Completa</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-stone-900 text-stone-100 min-h-screen p-6">


  <!-- LOGIN MASTER + IR AL TABLERO -->
  <div id="loginScreen" class="max-w-md mx-auto bg-stone-800 p-6 rounded-xl shadow-xl hidden">
    <h1 class="text-3xl font-bold text-center mb-4 text-red-400">Opciones</h1>

    <label>Entrar como Master:</label>
    <input id="masterPass" type="password" class="w-full p-2 rounded text-black mb-3" />

    <button onclick="loginMaster()" 
      class="w-full bg-red-600 hover:bg-red-700 p-2 rounded">
      Entrar como Master
    </button>

    <button onclick="enterBoard()" 
      class="w-full bg-purple-600 hover:bg-purple-700 p-2 rounded mt-4">
      Ir al Tablero
    </button>

    <button onclick="backToStart()" 
      class="w-full bg-gray-600 hover:bg-gray-700 p-2 rounded mt-3">
      Volver
    </button>
  </div>


  <script>
    let campaigns = JSON.parse(localStorage.getItem("campaigns")) || [];
    let currentCampaign = JSON.parse(localStorage.getItem("currentCampaign")) || null;

    window.addEventListener("load", () => {
      if (campaigns.length === 0) {
        openNewCampaignForm();
      } else {
        document.getElementById("startScreen").classList.remove("hidden");
      }
    });

    function backToStart() {
      document.querySelectorAll("#campaignCard,#campaignSelectCard,#loginScreen")
        .forEach(el => el.classList.add("hidden"));

      document.getElementById("startScreen").classList.remove("hidden");
    }

    function openNewCampaignForm() {
      document.getElementById("startScreen").classList.add("hidden");
      document.getElementById("campaignCard").classList.remove("hidden");
    }

    function openCampaignSelector() {
      document.getElementById("startScreen").classList.add("hidden");
      document.getElementById("campaignSelectCard").classList.remove("hidden");

      const select = document.getElementById("campaignSelect");
      select.innerHTML = "";

      campaigns.forEach((c, i) => {
        select.innerHTML += `<option value="${i}">${c.name}</option>`;
      });
    }

    function createCampaign() {
      const name = document.getElementById("campaignNameInput").value;
      const numPlayers = parseInt(document.getElementById("campaignPlayersInput").value);

      if (!name || !numPlayers) return alert("Completa todos los campos");

      const campaign = { name, numPlayers };
      campaigns.push(campaign);

      localStorage.setItem("campaigns", JSON.stringify(campaigns));
      localStorage.setItem("currentCampaign", JSON.stringify(campaign));

      showLoginOptions();
    }

    function chooseCampaign() {
      const idx = document.getElementById("campaignSelect").value;
      currentCampaign = campaigns[idx];

      localStorage.setItem("currentCampaign", JSON.stringify(currentCampaign));

      showLoginOptions();
    }

    function showLoginOptions() {
      document.querySelectorAll("#startScreen,#campaignCard,#campaignSelectCard")
        .forEach(el => el.classList.add("hidden"));

      document.getElementById("loginScreen").classList.remove("hidden");
    }

    function loginMaster() {
      const pass = document.getElementById("masterPass").value;
      if (pass === "dragon") {
        window.location.href = "./Player/master.html";
      } else alert("Contrase√±a incorrecta");
    }

    function enterBoard() {
      window.location.href = "./Player/player_view.html";
    }
  </script>

</body>
</html>
